<html>
<head>
<title>系统数据源</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="../../build/common/base.css" rel="stylesheet">
<script type="text/javascript" src="../../build/common/base.js"></script>
<script type="text/javascript" src="../../build/common/gridList.js"></script>
<script type="text/javascript">
	/**
	 * 测试连接
	 */
	function checkConnection(key) {
		var url = __ctx + "/sys/sysDataSource/checkConnection";
		//3 发请求
		jQuery.post(url, {
			key : key
		}, function(result) {
			if (result.data) {
				$.Toast.success(result.msg);
			} else {
				$.Toast.error(result.msg);
			}
		}, "json");
	};
</script>
</head>
<body class="panel-body">
	<div class="panel panel-default search-panel">
		<div class="panel-heading">
			查询条件
			<a 　href="javascript:void(0)" class="pull-right">
				<i class="fa  fa-angle-double-up" toggle-collapse="#searchForm"></i>
			</a>
		</div>
		<div class="panel-body">
			<form id="searchForm" class="form-horizontal">
				<div class="form-group">
					<label class="control-label col-sm-1" for="key_^VLK">别名</label>
					<div class="col-sm-2">
						<input type="text" class="form-control" id="key_^VLK">
					</div>
					<label class="control-label col-sm-1" for="name_^VLK">名称</label>
					<div class="col-sm-2">
						<input type="text" class="form-control" id="name_^VLK">
					</div>
					<div class="col-sm-3" style="text-align: left;">
						<button type="button" style="margin-left: 50px" class="btn btn-primary fa-search">查询</button>
						<button type="button" style="margin-left: 50px" class="btn btn-primary fa-rotate-left">重置</button>
					</div>
				</div>
			</form>
		</div>
	</div>
	<div class="btn-group toolbar">
		<button class="btn btn-outline btn-primary fa-plus" openDialog="新增" url="sysDataSourceEdit">新增</button>
	</div>
	<table ab-grid data-id-field="id" data-url="/sys/sysDataSource/listJson">
		<thead>
			<tr>
				<th data-checkbox="true">ID</th>
				<th data-field="key">别名</th>
				<th data-field="name">名称</th>
				<th data-field="dbType">数据库</th>
				<th data-formatter="innerHtmlFormatter" data-title="管理">
					<span class='btn btn-outline btn-primary fa-edit' openDialog='编辑' qtip='编辑' url='./sysDataSourceEdit.html?id={id}'></span>
					<span class='btn btn-outline btn-primary fa-desktop' qtip='测试链接' onclick="checkConnection('{key}')"></span>
					<span class='btn btn-outline btn-primary fa  fa-trash' sendAction='删除' qtip='删除' url='/sys/sysDataSource/remove?id={id}'></span>
				</th>
			</tr>
		</thead>
	</table>
</body>
</html>
